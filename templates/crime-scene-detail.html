{% extends "partials/admin-base.html" %}

{% load static %}
{% block content %}


  <!-- [ Main Content ] start -->
  <div class="pc-container">
    <div class="pc-content">
      <!-- [ breadcrumb ] start -->
      <div class="page-header">
        <div class="page-block">
          <div class="row align-items-center">
            <div class="col-md-12">
              <ul class="breadcrumb">
                <li class="breadcrumb-item"><a href="{% url "home" %}">Home</a></li>
                <li class="breadcrumb-item"><a href="{% url "crime-scenes-list" %}">Crime Scenes</a></li>
                <li class="breadcrumb-item" aria-current="page">Crime Scene Detail</li>
              </ul>
            </div>
            <div class="col-md-12">
              <div class="page-header-title">
                <h2 class="mb-0">Crime Scene Details</h2>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- [ breadcrumb ] end -->
      <!-- [ Main Content ] start -->
      <div class="row">
        <!-- [ sample-page ] start -->
        <div class="col-sm-12">
          
          <div class="tab-content">
            <div class="tab-pane show active" id="profile-1" role="tabpanel" aria-labelledby="profile-tab-1">
              <div class="row">
                
                <div class="col-lg-12 col-xxl-12">
                  {% if crime_scene %}
                  
                  <div class="card">
                    <div class="card-header">
                      <h5>Summary of Incident</h5>
                    </div>
                    <div class="card-body">
                      <ul class="list-group list-group-flush">
                        <li class="list-group-item px-0 pt-0">
                          <div class="row">
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Name Of Incident</p>
                              <p class="mb-0">{{crime_scene.name_of_incident}}</p>
                            </div>
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Nature of Incident</p>
                              <p class="mb-0">{{crime_scene.nature_of_incident}}</p>
                            </div>
                          </div>
                        </li>
                        <li class="list-group-item px-0">
                          <div class="row">
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Time</p>
                              <p class="mb-0">{{crime_scene.time}}</p>
                            </div>
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Date</p>
                              <p class="mb-0">{{crime_scene.date}}</p>
                            </div>
                          </div>
                        </li>
                        <li class="list-group-item px-0">
                          <div class="row">
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Location</p>
                              <p class="mb-0">{{crime_scene.location_of_incident}}</p>
                            </div>
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Weather Conditions</p>
                              <p class="mb-0">{{crime_scene.weather_conditions}}</p>
                            </div>
                          </div>
                        </li>
                        <li class="list-group-item px-0 pb-0">
                          <p class="mb-1 text-muted">Officer In Charge</p>
                          <p class="mb-0">{{crime_scene.user.first_name}} {{crime_scene.user.last_name}}</p>
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-header">
                      <h5>Images</h5>
                    </div>
                    <div class="card-body">
                      <ul class="list-group list-group-flush">
                        {% for image in crime_scene.images.all %}
                        <li class="list-group-item px-0 pt-0 mb-3">
                          <div class="row">
                            <div class="col-md-6">
                              <img src="{{image.image.url}}" width="50%" height="100%">
                            </div>
                            <div class="col-md-6">
                              <p class="mb-1 text-muted">Comment</p>
                              <p class="mb-0">{{image.comment}}</p>
                            </div>
                          </div>
                        </li>
                        {% endfor %}
                        
                      </ul>
                    </div>
                  </div>
                  <div class="card">
                    <div class="card-header">
                      <h5>Incident log</h5>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive">
                        <table class="table table-hover" id="pc-dt-simple">
                          <thead>
                            <tr>
                              <th>Visitor's Name</th>
                              <th>Reason for visiting</th>
                              <th>Date/Time</th>
                            </tr>
                          </thead>
                          <tbody>
        
                            {% for log in crime_scene.incident_logs.all %}
                                <tr>
                                  <td>{{log.visitor.first_name}} {{log.visitor.last_name}}</td>
                                  <td>{{log.reason_for_visiting}}</td>
                                  <td>{{log.date}}/{{log.time}}</td>
        
                                </tr>        
        
                            {% endfor %}
        
        
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  {% else %}

                  <div class="card">
                    <div class="card-header">
                      <h4 class="text-center f-w-500 mb-5">Request Access to this Crime Scene</h4>
                    </div>
                    <div class="card-body">

                      <form method="POST">
          
                      {% csrf_token %}
          
                          <div class="form-group mb-3">
                              <label class="form-label" for="reason">Reason for visiting</label>
                              <input type="text" class="form-control" name="reason" id="reason" placeholder="Reason for visiting the crime scene" required>
                          </div>
                                                  
                      
                          <div class="d-grid mt-4">
                              <button type="submit" class="btn btn-primary">Submit</button>
                          </div>
                      </form>
                    </div>
                    
                  </div>
                </div>
                  
                  {% endif %}
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <!-- [ sample-page ] end -->
      </div>
      <!-- [ Main Content ] end -->
    </div>
  </div>
  <!-- [ Main Content ] end -->
 

  {% endblock content %}